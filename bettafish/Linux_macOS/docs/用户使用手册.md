# BettaFish 用户使用手册

> 从零开始的完整指南，轻松部署和使用 BettaFish AI 系统

---

## 目录

1. [这是什么？](#这是什么)
2. [我能用它做什么？](#我能用它做什么)
3. [开始前的准备](#开始前的准备)
4. [傻瓜式部署教程](#傻瓜式部署教程)
5. [如何使用](#如何使用)
6. [遇到问题怎么办](#遇到问题怎么办)
7. [常见问题解答](#常见问题解答)

---

## 这是什么？

**BettaFish** 是一个强大的 AI 助手系统，可以帮您：
- 🤖 进行智能对话
- 🔍 搜索和分析信息
- 📊 生成洞察报告
- 📝 处理文本任务

本工具包帮您**一键部署**这个系统到您的电脑上，无需懂技术！

---

## 我能用它做什么？

### 主要功能

| 功能 | 说明 | 举例 |
|------|------|------|
| **智能对话** | 像 ChatGPT 一样聊天 | "帮我写一份商业计划书" |
| **信息搜索** | 联网搜索最新信息 | "2024年AI发展趋势是什么？" |
| **数据分析** | 分析和洞察数据 | "分析这份销售数据的趋势" |
| **内容生成** | 自动生成各类内容 | "帮我写一篇关于环保的文章" |

### 三大引擎

- **Insight Engine（洞察引擎）**：深度分析和洞察
- **Media Engine（媒体引擎）**：处理图片、视频等媒体
- **Query Engine（查询引擎）**：快速问答和信息检索

---

## 开始前的准备

### 第一步：检查你的电脑

确保你的电脑满足以下条件：

| 项目 | 最低要求 | 推荐配置 |
|------|----------|----------|
| **操作系统** | macOS 10.15+ 或 Ubuntu 20.04+ | macOS 最新版 |
| **内存** | 8GB | 16GB 或更多 |
| **硬盘空间** | 20GB 可用 | 50GB 或更多 |
| **网络** | 能上网即可 | 稳定的网络连接 |

**如何查看你的配置？**

在 macOS 上：
1. 点击左上角  图标
2. 选择"关于本机"
3. 查看"内存"和"存储空间"

### 第二步：安装 Docker

Docker 是运行 BettaFish 的必需软件，就像手机需要安装 APP 一样。

#### macOS 用户（超简单）

1. **下载 Docker Desktop**
   - 访问：https://www.docker.com/products/docker-desktop
   - 点击"Download for Mac"
   - 如果是 M1/M2/M3 芯片，选择 "Apple Chip"
   - 如果是 Intel 芯片，选择 "Intel Chip"

2. **安装 Docker**
   - 双击下载的 `.dmg` 文件
   - 把 Docker 图标拖到"应用程序"文件夹
   - 打开"应用程序"，双击 Docker 图标启动

3. **等待启动完成**
   - 第一次启动需要 1-2 分钟
   - 看到顶部菜单栏出现 Docker 鲸鱼图标就成功了

#### Linux 用户

```bash
# Ubuntu/Debian 用户运行：
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo usermod -aG docker $USER

# 重新登录后生效
```

### 第三步：获取 API 密钥

API 密钥就像是"门卡"，让你能使用 AI 服务。

#### 主 API 密钥（必须）

1. 访问：https://vibecodingapi.ai/
2. 注册账号（使用邮箱）
3. 登录后，在"API Keys"页面创建新密钥
4. 复制密钥（格式像：`sk-proj-xxxxxxxxxxxxx`）
5. **妥善保存**，后面要用！

#### Tavily 搜索密钥（强烈推荐）

如果需要联网搜索功能：

1. 访问：https://tavily.com/
2. 注册并登录
3. 获取免费 API 密钥
4. 保存密钥

#### Bocha 搜索密钥（可选）

这是备用搜索服务，可以不配置。

---

## 傻瓜式部署教程

现在开始真正的部署！只需 **3 步**，每步都有详细说明。

### 步骤 1：下载并解压部署包

#### macOS 用户

1. **下载部署包**
   - 把 `BettaFish-Deployment-Kit.zip` 文件保存到"下载"文件夹

2. **解压文件**
   - 双击 `.zip` 文件自动解压
   - 会生成一个名为 `BettaFish-Deployment-Kit` 的文件夹

3. **打开终端**
   - 按 `Command + 空格`
   - 输入 `terminal`（终端）
   - 按回车

4. **进入部署文件夹**
   ```bash
   cd ~/Downloads/BettaFish-Deployment-Kit
   ```
   - 复制上面这行命令
   - 在终端里右键 → 粘贴
   - 按回车

#### Linux 用户

```bash
cd ~/Downloads
unzip BettaFish-Deployment-Kit.zip
cd BettaFish-Deployment-Kit
```

### 步骤 2：运行部署脚本

现在，运行自动部署脚本：

```bash
# 1. 给脚本添加执行权限
chmod +x docker-deploy.sh

# 2. 运行脚本
./docker-deploy.sh
```

**小提示**：
- 复制上面两行命令
- 在终端粘贴后按回车
- 然后就坐等脚本自动完成吧！

### 步骤 3：按提示操作

脚本会引导你完成所有配置，下面是你会看到的画面：

#### 3.1 环境检测（自动）

```
  _      ___ ___  _   _  ____ ____       _    ___
 | |    |_ _/ _ \| \ | |/ ___/ ___|     / \  |_ _|
 | |     | | | | |  \| | |  | |        / _ \  | |
 | |___  | | |_| | |\  | |__| |___  _ / ___ \ | |
 |_____||___\___/|_| \_|\____\____|(_)_/   \_\___|

       🐟 BettaFish Docker 一键部署
        Powered by LIONCC.AI - 2025

▶ 步骤 1/7: 环境检测与依赖安装

ℹ️  开始环境检测...

  📱 操作系统: macOS
  💻 系统架构: arm64
  🌐 网络连接: ✓ 正常
  🐳 Docker:   ✓ 已安装 (v24.0.6)
```

**这个阶段你什么都不用做**，脚本会自动检测你的系统。

#### 3.2 配置 API 密钥（重要！）

```
▶ 步骤 3/7: 配置 API 密钥

请输入您的 API 配置信息:

主 API 密钥 [必填]:
```

现在轮到你了：

1. **输入主 API 密钥**
   - 粘贴你在"第三步"获取的 VibeAI 密钥
   - 格式：`sk-proj-xxxxxxxxxxxxx`
   - 按回车

2. **输入 Base URL**（通常直接回车用默认值）
   ```
   Base URL [可选，默认: https://vibecodingapi.ai/v1]:
   ```
   - 直接按回车使用默认值

3. **输入 Tavily 密钥**
   ```
   Tavily API 密钥 [推荐]:
   ```
   - 如果有，粘贴你的 Tavily 密钥
   - 如果没有，直接按回车跳过

4. **输入 Bocha 密钥**（可选）
   ```
   Bocha API 密钥 [可选]:
   ```
   - 直接按回车跳过

#### 3.3 选择镜像源（自动推荐）

```
ℹ️  测试镜像源网络连接速度...

测试结果:

  [1] 官方源 (ghcr.io) ... 457ms
  [2] 南京大学镜像 (ghcr.nju.edu.cn) ... 104ms ← 推荐
  [3] Docker Hub 官方 ... 751ms
  [4] 阿里云杭州 ... 140ms
  [5] 阿里云上海 ... 122ms

请选择镜像源 [0-5] (回车默认 0):
```

**怎么选？**
- **直接按回车**：使用推荐的最快源（最简单）
- 或者输入数字（比如输入 `2` 选择南京大学镜像）

#### 3.4 自动下载和启动（等待）

```
▶ 步骤 5/7: 拉取 Docker 镜像

ℹ️  开始拉取官方预构建镜像...
ℹ️  镜像大小约 5GB，预计 5-15 分钟

[+] Pulling...
[====================>] 85%
```

**这个阶段：**
- 脚本会自动下载约 5GB 的文件
- 需要 5-15 分钟（取决于网速）
- 你可以去喝杯咖啡 ☕️

#### 3.5 部署完成！

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🎉 恭喜！BettaFish 部署成功！

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🌐 访问地址:

  ● 主服务:       http://localhost:5001
  ● Insight Engine:    http://localhost:8501
  ● Media Engine:      http://localhost:8502
  ● Query Engine:      http://localhost:8503

📊 服务状态:

  ✓ bettafish        运行中
  ✓ bettafish-db     运行中

✅ 所有服务运行正常！

💡 下一步:
  1. 在浏览器打开 http://localhost:5001
  2. 开始使用 BettaFish！
```

**看到这个画面就成功了！** 🎊

---

## 如何使用

### 第一次使用

1. **打开浏览器**
   - 打开 Chrome、Safari 或 Firefox

2. **访问主服务**
   - 在地址栏输入：`http://localhost:5001`
   - 按回车

3. **开始使用**
   - 界面会自动打开
   - 你会看到一个聊天界面

### 基本操作

#### 使用主服务（推荐新手）

```
打开：http://localhost:5001
```

这是最简单的界面，就像使用 ChatGPT 一样：

1. 在输入框输入你的问题
2. 按"发送"按钮
3. 等待 AI 回复

**示例对话：**

```
你: 你好，介绍一下你自己

AI: 你好！我是 BettaFish，一个智能 AI 助手...

你: 帮我写一份关于环保的演讲稿

AI: 好的，我来帮你写一份环保主题的演讲稿...
```

#### 使用专业引擎（进阶）

如果需要使用特定功能：

**Insight Engine（洞察引擎）**
```
打开：http://localhost:8501
```
- 适合：深度分析、数据洞察
- 举例："分析这份市场报告的关键趋势"

**Media Engine（媒体引擎）**
```
打开：http://localhost:8502
```
- 适合：处理图片、视频
- 举例："描述这张图片的内容"

**Query Engine（查询引擎）**
```
打开：http://localhost:8503
```
- 适合：快速问答
- 举例："什么是量子计算？"

### 日常启动和关闭

#### 如何启动服务

如果重启电脑后，需要重新启动 BettaFish：

```bash
# 1. 打开终端

# 2. 进入项目目录
cd ~/Downloads/BettaFish-Deployment-Kit/BettaFish-main

# 3. 启动服务
docker-compose up -d

# 4. 等待 10-30 秒后即可访问
```

#### 如何关闭服务

不用时可以关闭节省资源：

```bash
# 1. 进入项目目录
cd ~/Downloads/BettaFish-Deployment-Kit/BettaFish-main

# 2. 停止服务
docker-compose stop
```

#### 检查服务状态

不确定服务是否在运行？

```bash
# 进入项目目录
cd ~/Downloads/BettaFish-Deployment-Kit/BettaFish-main

# 查看状态
docker-compose ps
```

**正常运行的样子：**
```
NAME            STATUS
bettafish       Up 5 minutes
bettafish-db    Up 5 minutes
```

---

## 遇到问题怎么办

### 问题诊断三步法

不管遇到什么问题，按这三步来：

#### 第 1 步：检查 Docker 是否运行

**macOS 用户：**
- 看顶部菜单栏有没有 Docker 鲸鱼图标
- 如果没有，打开"应用程序" → 双击 Docker

**Linux 用户：**
```bash
sudo systemctl status docker
```

#### 第 2 步：检查服务状态

```bash
cd ~/Downloads/BettaFish-Deployment-Kit/BettaFish-main
docker-compose ps
```

如果看到 `Exited` 或 `Restarting`，说明服务有问题。

#### 第 3 步：查看错误日志

```bash
cd ~/Downloads/BettaFish-Deployment-Kit/BettaFish-main

# 查看主服务日志
docker-compose logs bettafish

# 查看数据库日志
docker-compose logs db
```

日志会显示具体的错误信息。

### 快速修复清单

| 问题 | 快速解决 |
|------|----------|
| 🔴 无法访问网页 | 1. 检查 Docker 是否运行<br>2. 等待 30 秒再试<br>3. 检查端口是否正确 |
| 🔴 端口被占用 | 重新运行 `./docker-deploy.sh`，脚本会自动换端口 |
| 🔴 镜像下载失败 | 1. 检查网络连接<br>2. 重新运行脚本选择其他镜像源 |
| 🔴 API 密钥错误 | 1. 重新运行 `./docker-deploy.sh`<br>2. 输入正确的密钥 |
| 🔴 Docker 无法启动 | 1. 重启电脑<br>2. 重新安装 Docker Desktop |

---

## 常见问题解答

### 基础问题

**Q1: 我完全不懂技术，能用吗？**

✅ **能！** 本指南专为初次使用者设计，只要：
- 会复制粘贴命令
- 会打开浏览器
- 能按照步骤操作

就完全可以使用！

---

**Q2: 需要花钱吗？**

💰 **部分收费：**
- BettaFish 软件本身：**免费**
- Docker 软件：**免费**
- API 密钥：**需要付费**（VibeAI 通常有免费额度）

---

**Q3: 安全吗？会不会泄露隐私？**

🔒 **安全！**
- 所有服务运行在你的本地电脑
- 数据不会上传到其他地方
- 只有调用 API 时会联网

---

**Q4: 电脑会不会变慢？**

💻 **正常使用不会：**
- 占用约 4-6GB 内存
- 如果电脑配置较低，可能稍慢
- 不用时可以关闭服务释放资源

---

### 部署问题

**Q5: 脚本提示 "Permission denied" 怎么办？**

```bash
# 先运行这个命令添加权限
chmod +x docker-deploy.sh

# 然后再运行部署
./docker-deploy.sh
```

---

**Q6: Docker 提示要更新怎么办？**

👍 **建议更新：**
1. 点击 Docker 图标
2. 选择"Check for Updates"
3. 下载并安装更新
4. 重启 Docker
5. 重新运行部署脚本

---

**Q7: 镜像下载一直失败？**

🌐 **网络问题的解决办法：**

**方法 1：换镜像源**
```bash
# 重新运行脚本
./docker-deploy.sh

# 在选择镜像源时，选择不同的源
# 比如尝试：南京大学镜像、阿里云等
```

**方法 2：检查网络**
- 确保能正常上网
- 尝试访问 https://www.google.com
- 如果需要，使用 VPN

**方法 3：使用离线包**（最可靠）
- 如果部署包里包含 `offline-packages` 文件夹
- 脚本会自动使用离线镜像，无需下载

---

**Q8: 端口被占用怎么办？**

✅ **自动修复：**

脚本会自动检测端口占用并修复：

```
⚠️  默认端口 5001 已被占用
✅ 找到可用端口: 5002
✅ 端口配置已更新
```

然后访问新的端口即可（比如 `http://localhost:5002`）

---

### 使用问题

**Q9: 第一次打开网页很慢？**

⏱️ **这是正常的：**
- 首次启动需要初始化数据库
- 大约需要 30-60 秒
- 后续访问会很快

**建议：**
- 启动后等 1 分钟再访问
- 看到界面后刷新一次

---

**Q10: AI 回复很慢或没反应？**

🔍 **可能的原因：**

1. **API 密钥问题**
   ```bash
   # 检查配置
   cd ~/Downloads/BettaFish-Deployment-Kit/BettaFish-main
   cat .env | grep API_KEY
   ```
   - 确认密钥是否正确

2. **网络问题**
   - AI 需要联网调用 API
   - 检查网络连接

3. **服务未启动**
   ```bash
   docker-compose ps
   ```
   - 确认服务状态为 "Up"

---

**Q11: 如何查看历史对话？**

📝 **数据存储位置：**
- 对话记录保存在数据库中
- 位置：`./db_data/` 文件夹
- 只要不删除这个文件夹，记录就一直保留

---

**Q12: 可以同时打开多个引擎吗？**

✅ **可以！**
- 每个引擎有独立端口
- 可以同时在多个浏览器标签页打开
- 互不干扰

---

### 高级问题

**Q13: 如何更新到最新版本？**

🔄 **更新步骤：**

```bash
# 1. 下载新的部署包

# 2. 进入新的部署目录
cd ~/Downloads/BettaFish-Deployment-Kit

# 3. 重新运行部署脚本
./docker-deploy.sh

# 4. 选择"使用现有配置"保留你的设置
是否使用现有配置? [Y/n]: Y
```

**数据会丢失吗？**
- ✅ 配置不会丢失（自动保留）
- ✅ 数据库不会丢失（自动备份）

---

**Q14: 如何完全卸载？**

🗑️ **完全清理：**

```bash
# 1. 进入项目目录
cd ~/Downloads/BettaFish-Deployment-Kit/BettaFish-main

# 2. 停止并删除容器和数据
docker-compose down -v

# 3. 删除镜像
docker rmi ghcr.io/666ghj/bettafish:latest
docker rmi registry.cn-hangzhou.aliyuncs.com/library/postgres:15-alpine

# 4. 删除整个文件夹
cd ~
rm -rf ~/Downloads/BettaFish-Deployment-Kit
```

**警告：** 这会删除所有数据和配置！

---

**Q15: 可以在服务器上部署吗？**

🖥️ **可以！**

如果你有远程服务器（比如云服务器）：

```bash
# 在服务器上同样运行
./docker-deploy.sh

# 访问时使用服务器 IP
http://你的服务器IP:5001
```

**注意安全：**
- 配置防火墙
- 使用强密码
- 考虑添加 HTTPS

---

**Q16: 能在 Windows 上运行吗？**

💻 **可以，但需要：**

1. **安装 Windows 版 Docker Desktop**
   - 下载：https://www.docker.com/products/docker-desktop

2. **使用 WSL2**（推荐）
   - 安装 WSL2：https://aka.ms/wsl2
   - 在 WSL2 中运行部署脚本

3. **或使用 Git Bash**
   - 安装 Git for Windows
   - 使用 Git Bash 运行脚本

---

## 获取更多帮助

### 文档资源

- **技术文档**: [docs/technical/技术文档.md](docs/technical/技术文档.md)
- **故障排查**: [docs/guides/故障排查指南.md](docs/guides/故障排查指南.md)
- **快速开始**: [docs/guides/快速开始指南.md](docs/guides/快速开始指南.md)

### 日志文件

所有操作日志都保存在：
```
logs/deploy_YYYYMMDD_HHMMSS.log
```

遇到问题时，可以查看这个文件找到详细错误信息。

### 社区支持

- **GitHub Issues**: 报告 Bug 或提问
- **GitHub Discussions**: 与其他用户交流

---

## 总结：部署清单

在开始之前，快速检查：

- [ ] ✅ 电脑满足配置要求（8GB 内存，20GB 空间）
- [ ] ✅ 已安装 Docker Desktop 并启动
- [ ] ✅ 已获取 VibeAI API 密钥
- [ ] ✅ 网络连接正常
- [ ] ✅ 下载并解压了部署包

然后：

1. ⚡ 打开终端
2. ⚡ 运行 `./docker-deploy.sh`
3. ⚡ 按提示输入 API 密钥
4. ⚡ 等待自动完成
5. ⚡ 打开浏览器访问 `http://localhost:5001`

**就这么简单！**

---

## 祝你使用愉快！

如果本指南帮到了你，欢迎：
- ⭐ 给项目点个 Star
- 💬 分享给朋友
- 📝 反馈使用体验

**Have fun with BettaFish!** 🐟✨
